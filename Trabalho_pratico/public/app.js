const itens = {
  "origem-trap": {
    id: "origem-trap",
    titulo: "Origem do Trap",
    destaque: true,
    resumo: "Como o Trap surgiu nos EUA e virou fenÃ´meno global.",
    descricao:
      "O Trap surgiu nos Estados Unidos no inÃ­cio dos anos 2000, principalmente no sul, com artistas como T.I., Gucci Mane e Young Jeezy. O nome vem das 'trap houses', locais onde ocorriam atividades ilegais e que inspiraram as letras. O gÃªnero evoluiu misturando batidas eletrÃ´nicas com influÃªncias do hip-hop e hoje Ã© uma das principais vertentes musicais globais.",
    imagem: "/images/origemtrap.png",
    imagemAlt: "RepresentaÃ§Ã£o da origem do Trap",
    info: [
      { label: "RegiÃ£o de origem", value: "Sul dos EUA" },
      { label: "PerÃ­odo", value: "InÃ­cio dos anos 2000" },
      { label: "Pioneiros", value: "T.I., Gucci Mane, Young Jeezy" },
      { label: "CaracterÃ­sticas", value: "808 forte, hi-hats rÃ¡pidos, bass pesado" },
      { label: "InfluÃªncia global", value: "Popularidade em diversos paÃ­ses e subgÃªneros" }
    ]
  },

  "artistas-alta": {
    id: "artistas-alta",
    titulo: "Artistas em Alta",
    destaque: true,
    resumo: "Nomes que impulsionam o Trap nacional.",
    descricao:
      "No Brasil, nomes como MatuÃª, Teto, Veigh, Yunk Vino, Japa e KayBlack estÃ£o entre os principais representantes do Trap moderno. Eles misturam influÃªncias do rap americano com a sonoridade local, criando produÃ§Ãµes que conquistam milhÃµes de ouvintes nas plataformas digitais.",
    imagem: "/images/fototrapers.PNG",
    imagemAlt: "Artistas brasileiros de Trap",
    info: [
      { label: "CenÃ¡rio", value: "Brasil" },
      { label: "Destaques", value: "MatuÃª, Teto, Veigh, Yunk Vino, Japa, KayBlack" },
      { label: "Plataformas", value: "Spotify, YouTube Music, Deezer" },
      { label: "TendÃªncia", value: "FusÃ£o de estilos e colaboraÃ§Ãµes" },
      { label: "ProduÃ§Ã£o", value: "Beats modernos e estÃ©tica forte" }
    ],

    midiaEmbed: [
      {
        album: "https://open.spotify.com/embed/album/3lXVOBlBz0s2iun2ocA5Gn?utm_source=generator",
        faixas: [
          "https://open.spotify.com/embed/track/4zVaPRho7i7z68Au6gVAmz?utm_source=generator",
          "https://open.spotify.com/embed/track/78LW2UJ7LSnHKwIWjmpXR0?utm_source=generator",
          "https://open.spotify.com/embed/track/5lXxagbzU5cMzoZqjlGmga?utm_source=generator"
        ]
      },
      {
        album: "https://open.spotify.com/embed/album/3VGvkH5X8bhjIV0rSohaVU?utm_source=generator",
        faixas: [
          "https://open.spotify.com/embed/track/0GsQzTpegvifzQZ4wXsCZ2?utm_source=generator",
          "https://open.spotify.com/embed/track/0HWYFn8L5lLLz9zKGnga5h?utm_source=generator&theme=0",
          "https://open.spotify.com/embed/track/70D4ZYmLC8Kxxw4rGthU0Q?utm_source=generator"
        ]
      },
      {
        album: "https://open.spotify.com/embed/album/6ehm0SMBBoSxH8oSrFXre6?utm_source=generator&theme=0",
        faixas: [
          "https://open.spotify.com/embed/track/2XymTaHTrQWDEuSyhfZvqF?utm_source=generator",
          "https://open.spotify.com/embed/track/5oI9blwsXC8AkTWw6wASY8?utm_source=generator",
          "https://open.spotify.com/embed/track/0bV0LtjtZH76gD0ujPYS3n?utm_source=generator&theme=0"
        ]
      },
      {
        album: "https://open.spotify.com/embed/album/6Y6PHaGPDkAYVuOxGfISi0?utm_source=generator",
        faixas: [
          "https://open.spotify.com/embed/track/5JX23868UTT3DBgj7i5yrK?utm_source=generator&theme=0",
          "https://open.spotify.com/embed/track/0vrUXMImjUJ511YAJrVo3d?utm_source=generator"
        ]
      }
    ]
  },

  "top-100": {
    id: "top-100",
    titulo: "Top 20 Trap Brasil",
    destaque: false,
    resumo: "Artistas brasileiros mais ouvidos do gÃªnero Trap nas plataformas digitais.",
    descricao:
      "Confira abaixo os principais nomes do Trap nacional e suas canÃ§Ãµes mais escutadas nas plataformas digitais.",
    imagem: "/images/top20.jpg",
    imagemAlt: "Ranking dos mais ouvidos",
    info: [
      { label: "Fonte", value: "Spotify, YouTube Music e RapMÃ­dia" },
      { label: "AtualizaÃ§Ã£o", value: "Outubro de 2025" },
      { label: "CritÃ©rio", value: "NÃºmero de streams e popularidade geral" }
    ],
    topArtistas: [
      { artista: "Bin", musica: "Saturno" },
      { artista: "Oruam", musica: "Lei Anti O.R.U.A.M" },
      { artista: "Veigh", musica: "Novo BalanÃ§o" },
      { artista: "Filipe Ret", musica: "Chefe do crime perfeito" },
      { artista: "MC Cabelinho", musica: "X1" },
      { artista: "Orochi", musica: "BalÃ£o" },
      { artista: "L7nnon", musica: "Freio da blazer" },
      { artista: "KayBlack", musica: "Licor 43" },
      { artista: "WIU", musica: "CoraÃ§Ã£o de Gelo" },
      { artista: "MatuÃª", musica: "Kenny G" },
      { artista: "Teto", musica: "Fim de Semana no Rio" },
      { artista: "Japa", musica: "Dejavu" },
      { artista: "Yunk Vino", musica: "Leans pt.2" },
      { artista: "Sidoka", musica: "Louis V menina linda" },
      { artista: "Ngc Daddy", musica: "Glockada" },
      { artista: "Dfideliz", musica: "ConfissÃµes pt1" },
      { artista: "Jovem Dex", musica: "Nav" },
      { artista: "Kawe", musica: "Jordan" },
      { artista: "MD Chefe", musica: "Tiffany" },
      { artista: "Borges", musica: "AK do flamengo" }
    ]
  }
};

function getQueryId() {
  const params = new URLSearchParams(window.location.search);
  return params.get("id");
}
function createEl(tag, className, html) {
  const el = document.createElement(tag);
  if (className) el.className = className;
  if (html !== undefined) el.innerHTML = html;
  return el;
}

function renderHome() {
  const lista = Object.values(itens);
  const destaques = lista.filter(i => i.destaque);
  renderCarousel(destaques);
  renderCards(lista);
}

function renderCarousel(itemsArr) {
  const indicators = document.getElementById("carouselIndicators");
  const inner = document.getElementById("carouselInner");
  if (!indicators || !inner) return;
  indicators.innerHTML = "";
  inner.innerHTML = "";

  itemsArr.forEach((item, i) => {
    const li = createEl("button");
    li.type = "button";
    li.dataset.bsTarget = "#destaquesCarousel";
    li.dataset.bsSlideTo = i;
    if (i === 0) li.classList.add("active");
    indicators.appendChild(li);

    const slide = createEl("div", `carousel-item ${i === 0 ? "active" : ""}`);
    const img = createEl("img", "d-block w-100");
    img.src = item.imagem;
    img.alt = item.imagemAlt;
    img.style.maxHeight = "420px";
    img.style.objectFit = "cover";

    const caption = createEl("div", "carousel-caption d-none d-md-block bg-blur",
      `<h5>${item.titulo}</h5><p>${item.resumo}</p><a href="detalhes.html?id=${item.id}" class="btn btn-sm btn-light">Ver detalhes</a>`
    );

    slide.appendChild(img);
    slide.appendChild(caption);
    inner.appendChild(slide);
  });
}

function renderCards(itemsArr) {
  const container = document.getElementById("cardsContainer");
  if (!container) return;
  container.innerHTML = "";

  itemsArr.forEach(item => {
    const col = createEl("div", "col-12 col-sm-6 col-lg-4");
    const card = createEl("div", "card bg-dark text-white h-100 p-3");

    const img = createEl("img", "img-cover mb-3");
    img.src = item.imagem;
    img.alt = item.imagemAlt;

    const title = createEl("h3", "h5",
      `<a class="text-white text-decoration-none" href="detalhes.html?id=${item.id}">${item.titulo}</a>`
    );
    const desc = createEl("p", "", item.descricao);

    card.appendChild(img);
    card.appendChild(title);
    card.appendChild(desc);
    col.appendChild(card);
    container.appendChild(col);
  });
}

function renderDetalhes() {
  const id = getQueryId();
  const item = itens[id];
  const titulo = document.getElementById("titulo-item");
  const infoC = document.getElementById("info-container");

  if (!item || !infoC) return;
  titulo.textContent = item.titulo;

  const col1 = createEl("div", "col-12");
  const card1 = createEl("div", "card bg-dark text-white p-4");

  const img = createEl("img", "img-cover mb-3");
  img.src = item.imagem;
  img.alt = item.imagemAlt;
  card1.appendChild(img);

  const desc = createEl("p", "", item.descricao);
  card1.appendChild(desc);

  if (item.midiaEmbed) {
    card1.appendChild(createEl("h3", "h5 mt-3", "MÃ­dias em Destaque"));
    item.midiaEmbed.forEach((a, i) => {
      card1.appendChild(createEl("h4", "h6 mt-3", `Ãlbum ${i + 1}`));
      const alb = createEl("iframe", "w-100 rounded mb-3");
      alb.src = a.album;
      alb.height = "352";
      alb.allow = "autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture";
      alb.frameBorder = "0";
      card1.appendChild(alb);
      a.faixas.forEach((fx, j) => {
        card1.appendChild(createEl("h5", "mt-2", `Faixa ${j + 1}`));
        const f = createEl("iframe", "w-100 rounded mb-3 musica");
        f.src = fx;
        f.height = "152";
        f.allow = "autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture";
        f.frameBorder = "0";
        card1.appendChild(f);
      });
    });
  }

  if (item.topArtistas) {
    card1.appendChild(createEl("h3", "h5 mt-4", "ðŸŽ§ Top 20 Artistas de Trap do Brasil"));
    const ol = createEl("ol", "list-group list-group-numbered");
    item.topArtistas.forEach(obj => {
      const li = createEl("li", "list-group-item bg-transparent text-white d-flex justify-content-between align-items-center");
      li.innerHTML = `<span>${obj.artista}</span><span>ðŸŽµ ${obj.musica}</span>`;
      ol.appendChild(li);
    });
    card1.appendChild(ol);
  }

  col1.appendChild(card1);
  infoC.appendChild(col1);
}

document.addEventListener("DOMContentLoaded", () => {
  if (document.getElementById("cardsContainer")) renderHome();
  if (document.getElementById("info-container")) renderDetalhes();
});